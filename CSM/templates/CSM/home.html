{% extends "CSM/include/base.html" %}

{% block title %}
    Home Page
{% endblock  %}

{% block content %}
    {% include "CSM/include/nav.html" %}
        <section class="flex justify-center">
            <div class="container my-4 px-4 flex h-auto ">
                <!-- Senders container -->
                <div class="w-[20%] min-h-[26rem] max-h-[27rem] flex flex-col gap-1 border-r-4 border-solid border-slate-400 bg-blue-100 rounded-l-lg overflow-hidden overflow-y-auto scroll-smooth">
                    {% if messages  != 0 %}
                        {% for message in messages %}
                            {% if message.id in unreaded %} 
                                <a class="bg-red-200 rounded-l-lg text-neutral-500 transition duration-200 hover:bg-slate-100 hover:text-blue-700 hover:ease-in-out focus:text-green-700 disabled:text-black/30 dark:text-neutral-200 dark:hover:text-neutral-300 dark:focus:text-neutral-300 sm:flex [&amp;.active]:text-black/90 dark:[&amp;.active]:text-zinc-400 motion-reduce:transition-none user" id="{{message.reciever}}{{message.id}}">
                                    <!-- Image of The Sender -->
                                    <div class="flex flex-col items-center justify-center mx-2">
                                        <img src="{{message.sender.employee.profile_pic.url}}" class="bg-red-600 border border-solid border-1 border-slate-600 rounded-full w-[50px] h-[50px]">
                                    </div>
                                    <!-- First Name and Last of The Sender -->
                                    <div class="flex flex-col items-center justify-center px-2 mx-2">
                                        <span class="text-base min-w-[6rem]">{{ message.sender.first_name }}</span>
                                        <span class="text-base min-w-[6rem]">{{ message.sender.last_name }}</span>
                                    </div>
                                </a>
                            {% else %}
                                <a class="bg-green-100 rounded-l-lg text-neutral-500 transition duration-200 hover:bg-slate-100 hover:text-blue-700 hover:ease-in-out focus:text-green-700 disabled:text-black/30 dark:text-neutral-200 dark:hover:text-neutral-300 dark:focus:text-neutral-300 sm:flex [&amp;.active]:text-black/90 dark:[&amp;.active]:text-zinc-400 motion-reduce:transition-none user" id="{{message.reciever}}{{message.id}}">
                                    <!-- Image of The Sender -->
                                    <div class="flex flex-col items-center justify-center mx-2">
                                        <img src="{{message.sender.employee.profile_pic.url}}" class="bg-red-600 border border-solid border-1 border-slate-600 rounded-full w-[50px] h-[50px]">
                                    </div>
                                    <!-- First Name and Last of The Sender -->
                                    <div class="flex flex-col items-center justify-center px-2 mx-2">
                                        <span class="text-base min-w-[6rem]">{{ message.sender.first_name }}</span>
                                        <span class="text-base min-w-[6rem]">{{ message.sender.last_name }}</span>
                                    </div>
                                </a>
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                </div>
                <!-- Message Container -->
                <div class="w-[80%] min-h-[26rem] max-h-[27rem] flex flex-col">
                    <!-- Title of The Message -->
                    <div class="flex justify-center w-full h-[10%] border-b-2 border-solid border-slate-400 px-2 mx-2 bg-blue-200">
                        <span class="px-2 mx-2 text-red-500">The is The Title The Message</span>
                    </div>
                    <!-- The Message -->
                    <div class="w-full px-2 py-2 mx-2 h-[80%]">
                        {% for message in messages %}
                        <p class="message-visible hidden" id="{{message.reciever}}{{message.id}}" dir="{% if message.id in ar_messages_ids%}rtl{% else %}ltr{% endif%}">{{ message.message}}</p>
                        {% endfor %}
                    </div>
                    <!-- Information About the Message -->
                    <div class="w-full h-[10%] flex items-center justify-center px-2 mx-2 border-t-2 border-slate-400 bg-blue-200">
                        <span class="text-red-500">2023/12/02 14:44</span>
                    </div>
                </div>

            </div>
        </section>
    {% include "CSM/include/footer.html" %}
{% endblock  %}

{% block scripts %}
    <script>
        allMessages = document.querySelectorAll('.message-visible');
        allUser = document.querySelectorAll('.user');

        allUser.forEach(function (userElement) {
            userElement.addEventListener('click', function () {
                allMessages.forEach(function (messageElement) {
                    if(userElement.id == messageElement.id){
                        messageElement.classList.remove('hidden')
                    }else{
                        messageElement.classList.add('hidden')
                    }
                })

            })
        });
    </script>
{% endblock %}



